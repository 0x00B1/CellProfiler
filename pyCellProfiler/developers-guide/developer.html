<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
<div id="mainContent">
<h1>Developer's Guide</h1>
<ul>
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#python">Python code</a></li>
	<ul>
		<li><a href="#python-style_guide">Style guide</a></li>
        <ul>
        	<li><a href="#python-style_guide-module_help">Module Help</a></li>
            <li><a href="#python-style_guide-settings_help">Settings Help</a></li>
        </ul>
	  <li><a href="#python-module_simplification">Module simplification</a></li>

	</ul>
</ul>

<h1><a name="intro"></a>Introduction</h1>

<p>This document describes the code standards for CellProfiler, and gives tips
   for CellProfiler developers.</p>

<h1><a name="#python"></a>Python code</h1>

<h2><a name="python-style_guide"></a>Style guide</h2>

<h3><a name="python-style_guide-module_help"></a>Module Help</h3>
<p>The Module Help window (which also constitutes a section of the   CellProfiler manual) is populated by the documentation string of the   module's code, and contains the following: </p>
<ol>
  <li> <strong>The module's name:</strong> This is printed as a title automatically and is not specified within   the code for the module.</li>
  <li> <strong>'''&lt;b&gt; Module name &lt;/b&gt; phrase description</strong>.<br />
      <em>Example:</em> <strong>Identify Prim Automatic</strong> identifies objects via thresholding and contouring.<br />
    The section begins with threee single quotes. While the module's official name has no spaces, in this case use spaces and   sentence case to make it comprehensible. The phrase description is   something like:  &quot;identifies primary objects...&quot;  or &quot;places outlines   of objects...&quot;</li>
  <li><strong>&lt;hr&gt;</strong>: Creates a horizontal line</li>
  <li><strong>Full description/explanation of the module's function.</strong> Use headings, usually level &lt;h2&gt;, when needed</li>
  <li><strong>Features that can be measured by this module</strong>: Provide as an unordered list, like this<br />
      <pre>&lt;ul&gt;<br />
    &lt;li&gt;&lt;i&gt;First measurement:&lt;/i&gt; Description of first measurement&lt;/li&gt; <br />
    &lt;li&gt;&lt;i&gt;Second measurement:&lt;/i&gt; Descrption of second measurement &lt;/li&gt; <br />
&lt;/ul&gt;</pre>
    This creates a bulleted list of measurements that the module can make.   We say &quot;can&quot; because depending on the user's settings, not all   measurements will be made by a module during a run. We will eventually   make modules self-aware so that the list of possible measurements that   can be made will be generated by the code of the module itself.</li>
  <li><strong>See also: &lt;b&gt;OtherModuleName&lt;/b&gt;: </strong>Other relevant/related modules are listed here</li>
  <li> <strong>''' (end quotes): </strong>The general module help section ends with three single quotes</li>
  <li>License information follows and is commented out using #</li>
  <li>The help for the settings is obtained from the code itself (see below) and hence, does not need to be written out here</li>
</ol>
<h3><a name="python-style_guide-settings_help"></a>Settings help</h3>
<p>In general, settings descriptions (which are displayed to the user in   the GUI) should be as concise as possible. For example,  <em>Enter the threshold scaling   factor</em> becomes <em>Threshold scaling factor</em>.</p>
<p>Some common standardized settings descriptions: </p>
<ul>
  <li><em>Select the input image</em></li>
  <li><em>Name the output image</em></li>
  <li><em>Name the identified objects</em></li>
</ul>
In these cases, copy the existing wordy description (e.g., <em>What do you want    to call...?</em>) to the first part of the help for that setting.
<p>The text for each setting's help is grabbed from the module's code, where   it looks like this: <br />
</p>
<pre>def create_settings(...):       <br />
    self.foo = cps.Bar(&quot;Quox&quot;, True, doc = '''
          Setting help is here bla bla,
          bla bla bla 
          bla bla''') </pre>
Note that the text for the setting is indented to line up at least after the period within <em>self.foo</em>.
<p>General stylistic notes</p>
<ul>
  <li> Other module names that are mentioned in the help should be <strong>&lt;b&gt; bold   &lt;/b&gt;</strong>. We will add hyperlinking function to go the other module's help   eventually.</li>
  <li>References that are mentioned should be <em>&lt;i&gt; italicized &lt;/i&gt;</em></li>
</ul>

<h2><a name="python-module_simplification"></a>Module simplification</h2>
<p> See <em>imagemath.py</em> for an example. 
<ul>
<li>The order of the methods in each module should be: 
<blockquote><pre>
create_settings
settings
visible_settings
prepare_to_set_values
run
backwards_compatibilize</pre></blockquote>
<p>This list isn't exhaustive. <em>backwards_compatibilize</em> should definitely be last. Use judgment with others. Helper methods should be near the method they help. (see <em>imagemath</em>'s add_image).</li>
<li><em>module_name</em> should be a class variable (not set in create_settings) </li>
<li>Settings
<ul>
	<li>Dynamic groups of settings should use cps.SettingsGroup (see imagemath.py for how to do this)</li>
	<li>Use cps.Divider to insert spaces between settings</li>
    <li>If code is going to use a setting's value more than once or twice, extract it to a local variable to avoid having to type self.setting.value too many times. (see the opval local variable in imagemath's <em>run()</em> method)</li>
    </ul></li></ul> </p>
</div>
</body>

</html>
