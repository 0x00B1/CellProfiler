Project:
+ Major enhancements/restructuring of some data tools:

- Combine code for Histograms (ISN'T This done already?)
=>Jun 7/26/06: Yes

- (Requested by Anne 12-09-05)-- See 'Potential improvement' in the Histogram data tool.
% Potential improvement: You might want to load names (using LoadText
% module or AddData data tool) for each image so that each histogram you
% make will be labeled with those names. We hope to someday improve the
% module to allow this. If you choose to import sample names here, you will
% need to select a text file that contains one name for every sample, even
% if you only plan to view a subset of the image data as histograms.
=>Jun: Changes already made and Histogram.m committed on 7/17/06. See in TODO_DONE.txt: (Jun, 7/17/06) (Requested by Anne 7-11-06). 'Potential improvement' text removed from help in Histogram.m. Help also updated. Histogram.m committed with these new changes on 7/26/06.

- (Requested by Anne 11-08-05) - Can we make PlotMeasurements as cool as Histograms? e.g. selecting subsets of images, 'gating' by plotting only cells above a threshold in a particular measurement.

- Make the histogram interface 'prettier' right now, the two pages of endless questions are kind of annoying. Making one nice interface, with checkboxes etc. to make it more user friendly would be great.
=>Jun: Changes made 7/26/07-8-1-06.  Completely redesigned menu to make it more robust and less error prone, now with mostly checkboxes and fewer text edit fields. Included more error checks for invalid text edit entries, as well as error checks for popup menus. Also fixed error in MatLab command line that occurred when clicking "Cancel" in the "Decimals" input dialog of the Histogram window. Changes made to Histogram.m, CPhistbins.m, and CPcontrolhistogram.m. 

- (Requested by Anne 1-17-06) - Histogram data tool requests:
* When the Histogram function fails in CPhistbins (e.g. if you enter a min greater than your max), it yields errors at the command line - they are not caught properly.
* I put in an error catch for the case where you have a negative number for the min histogram bin value, but try to plot in log scale, because it fails. Can we make this work?
* Overall, the compressed heat maps section seems poorly designed - we kind of threw it together. (esp swapping the axes, 'image' vs 'bin' - the X and Y axis labels are swapped for one of the modes.) Need to go through and make it more logical, perhaps by adding subfunctions to consolidate the code.
* When making compressed heat maps, it does not seem to round off the tick labels - there are tons of decimal places. Can we fix? It seems like the compressed heat maps should have the same options as the other types of histograms: fewer tick labels, change number of decimals (wait, maybe that's from the ShowDataOnImage tool), etc.

=================

TODO's

Jun 7/24/06: Window cuts off text in rotate module when not in first cycle of pipeline. 

Jun 8-1-06: Need to redesign Add Control Histogram window. Also, an error occurs when you click "Cancel" in the  window. 
=>Jun: Changes made 8-1-06. Changed text edit fields to popup menus to reduce error. Added more options to color selection. CPcontrolhistogram.m committed on 8-1-06.

- Anne 7/24/06: Check clarity of help for DefineGrid, DisplayHistogram, Exclude, and ExportToExcel modules and Histogram data tool.
=>Jun: Changes made 8/1/06. DefineGrid.m, DisplayHistogram.m, Exclude.m, ExportToExcel.m, and Histogram.m committed on 8/1/06.

- Anne 7/24/06: Check clarity of help for ApplyThreshold, CalculateRatios, ColorToGray, CorrectIllumination_Apply, and CreateBatchFiles modules. 
=>Jun: Changes made 7/25/06. ApplyThreshold.m, ColorToGray.m, CorrectIllumination_Apply.m, and CreateBatchFiles.m committed on 7/25/06.

Jun 7/19/06: Redesign Measurement Calculator window. Font sizes are too small, there is unwanted text, pop up menus have white boxes around them, and general resizing needs to be done.
=>Jun: Changes made 7/24/06-7/25/06. Fixed errors associated with repeated user input and with closing window. Modified confirmation message. Increased spacing and font. Also added help button and made instructions more clear. MeasurementCalculator.m committed on 7/25/06.

Jun 7/21/06: Need to wait for user input for warning dialogs and message boxes in Rotate and Crop modules. When a warning or message occurs in mouse mode while running the pipeline, other windows refresh and usually cover them. Warning dialogs and message boxes should be kept on top of all other windows until user closes them.
=>Jun: Changes made 7/24/06. Rotate.m and Crop.m committed on 7/24/06.

- Anne 7-12-06: The ExportData window needs a bit of redesign. The question Ignore NaN's should be a pulldown menu yes/no (just like the other questions) rather than a checkbox, because depending on how many objects you have (On my computer, this happens when i only have Image + Nuclei), it looks like "Ignore NaN's" is one of the measurements you can choose to export. Also, the pulldown menus have funny-colored corners rather than purple corners. Overall it seems kind of random and messy, so more ideas on how to make it easier to understand would be great. Keep in mind the window size changes depending on how many types of objects you have in the output file.
=>Jun: Changes made 7/18/06-7/24/06. Pipeline settings will be saved under same base name as exported data. Added warning message if user does not select any data, and allows user to try again. Redesigned window to be more clear and organized. ExportData.m committed 7/24/06.

Jun 7/19/06: In the "Change Colormap" window of Image Tool, some of the text is cut off. Also, pop up menus in many places have a white box around them. Need to fix background color of these pop up menus.
=>Jun: Changes made 7/19/06-7/21/06.  CPimagetool.m committed on 7/21/06.

Jun 7/18/06: Modify outdated error messages about not finding images or objects in the pipeline.
=>Jun: Changes made 7/18/06. CPaverageimages.m, CPretrieveimage.m, SaveImages.m, and DefineGrid.m committed on 7/18/06.

- Anne 7-13-06: We no longer allow the user to import data permanently
into the handles structure so this part [in CellProfiler.m] is no longer ever applicable. Besides, the LoadText module and AddData data tool use the word "Description" to denote this user-added data rather than the word
"Imported". So we think it is safe to remove this code permanently.
=>Jun: Changes made 7/17/06-7/18/06. Removed code and tested for problems. CellProfiler.m committed on 7/18/06.

- Anne 7-11-06: It doesn't make sense (I am pretty sure) to allow the user to choose "FileNamesText" when deciding how to label the histograms in the histograms data tool. So we should remove FileNamesText from the choices. We should leave FileNames as selectable. The reason the user is given the choice is because if you had used the Add Data tool you might have entered your own text data (like gene names) and so you might want to choose those instead of FileNames.
=>Jun: Changes made 7/12/06-7/17/06. Also fixed problems with showing imported filenames when creating histogram and displaying titles and axes labels in "Add Control Histogram" button. Histogram.m and CPcontrolhistogram.m committed on 7/17/06.

- Anne 7-11-06: The Crop module, in mouse/ellipse mode, does not visibly mark the points that you have clicked. It's kind of strange because I think at one point it did this successfully, and the mouse/rectangle mode works just fine, creating little star marks wherever you have clicked.
=>Jun: Changes made 7/12/06. Also added check for correct number of mouse clicks, allowing user to try again. Crop.m committed on 7/12/06.

- Anne 7-11-06: In the Rotate module, at this line:
        if length(x) < 2
            error(['Image processing was canceled in the ', ModuleName, ' module because you must click on at least two points then press enter.'])
        end
Instead of producing an error and canceling out, the module should ask the user to start over again - that is, getpts should be repeated from scratch. I imagine this would use the "while" function.
=>Jun: Changes made 7/11/06-7/12/06.  Rotate.m committed on 7/12/06.

- Anne 7-7-06: the histogram flipping looks great and hopefully will make the reviewers of our paper happy! I only noticed one small problem, when you plot something with the axes flipped and then add a control histogram, the control histogram is not flipped but is in the normal orientation instead. It would be a reasonable solution to just disable/remove the button when in flipped mode, because I don't think people will use that combination very often. But if it's easy to fix, go ahead. Also, the button Export Data To MATLAB should be non visible when running the compiled version. I don't know how we normally disable functions in the compiled version, but Mike can tell you.
=>Jun: Changes made 7/10/06-7/11/06. "Add a Control Histogram" button was fixed. Histogram.m and CPcontrolhistogram.m committed on 7/11/06.

- Anne 6-21-06: We would like to run some tests to try to improve CellProfiler's speed: 
* Change CPimread to put the images in single format rather than double. We hypothesize that subsequent processing in single format will be faster. We are pretty certain that we won't lose any precision, because we are using 12-bit and occasionally 16-bit images, whereas single precision already has more than 20-bit data storage capability; therefore we think double precision is overkill. However, we don't know whether all of the matlab functions will work on single format numbers, so we should run a long test pipeline to see if any errors result. It's also possible that many MATLAB functions may process single precision numbers by converting to double and back again, which would make single precision numbers be slower! Run comparisons of how long processing takes in double and in single format to help us decide whether it's worth it to switch to single.
* What are the most time-consuming steps of IdentifyPrimAutomatic? Use the "Profiler" tool within MATLAB to determine this.
=>Jun: Testing done 7/3/06-7/10/06, documented in word file. It seems that it's not worth it to switch to single format. In some cases, double is faster and in other cases single is faster, but the difference is usually only 10% or less. There are also a few errors associated with switching to single.

- (Anne 6/12/06) - After you save preferences, it tells you that they are saved in the matlab root directory, which is not true for the non-developer's version of CellProfiler (see the Set Preferences window for a description of what really happens; i think it is up to date).
=>Jun: Changes made 6/30/06. CellProfiler.m committed on 6/30/06.

(Anne 6/27/06): Need to add option to Histogram menu to flip x and y axes when plotting graphs.
=>Jun: Changes made 6/27/06-6/30/06. Histogram.m committed on 6/30/06.

- Anne 6-20-06: Let's make a more informative error window that tells the user possible reasons why the image might not be found:
Question:"I have been trying to persuade CellProfiler to save images generated by tiled, but every time SaveImages complains about not being able to find the input image. I set this to be the output image of Tiled. I am running cellprofiler on MacOS 10.4.6. Am I missing something or is this a known bug ... "
Answer: "The full tiled image is only made on the final cycle, so you must set the SaveImages module to save on "Last Cycle" instead of All. That should take care of your problem!"
=> Jun: Changes made 6/23/06-6/27/06. Processing will continue when user saves tiled image(s) on cycles other than the last. Instead of an error, user gets warning. Error still occurs for images not existent in pipeline. SaveImages.m and Tile.m committed on 6/30/06.

- (Anne 6/12/06) - LoadSingleImage seems to spit its text display into other windows, depending on what you have open and are looking at. Maybe this a fluke, transient thing but perhaps we can make it put its text in the proper window more consistently? If we fix it for this module, make sure LoadImages is also working similarly.
=> Jun: Changes made 6/22/06. LoadImages.m and LoadSingleImage.m committed on 6/30/06.